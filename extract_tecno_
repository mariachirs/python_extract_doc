def extract_technologies_from_docx(doc, stop_header="Langues parlées, écrites"):
    category_pattern = re.compile(r"^(.*?):\s*$")
    entry_pattern = re.compile(r"(.+?)\t(\d+)$")

    results = defaultdict(list)
    current_category = None

    for para in doc.paragraphs:
        line = para.text.strip()
        if not line:
            continue

        if stop_header.lower() in line.lower():
            break

        category_match = category_pattern.match(line)
        if category_match:
            current_category = category_match.group(1).strip()
            continue

        if current_category:
            entry_match = entry_pattern.match(line)
            if entry_match:
                name = entry_match.group(1).strip()
                months = int(entry_match.group(2))
                results[current_category].append((name, months))

    return dict(results)
