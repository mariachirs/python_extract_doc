from docx import Document
from typing import List, Tuple

def extract_languages_exact(file_path: str) -> List[Tuple[str, str]]:
    doc = Document(file_path)
    extracting = False
    buffer = []

    # Define known section headers to stop at
    stop_headers = {
        "Certifications",
        "Résumé des interventions",
        "Technologies",
        "Perfectionnement",
        "Formation académique",
        "Autres formations",
        "Associations",
        "Publications",
        "Conférences données ou suivies",
    }

    for para in doc.paragraphs:
        text = para.text.strip()

        if not text:
            continue

        # Look for the exact header to start
        if text == "Langues parlées, écrites":
            extracting = True
            continue

        # If already extracting, stop at the next known header
        if extracting and text in stop_headers:
            break

        if extracting:
            buffer.append(text)

    # Simple pairing of languages with their levels
    half = len(buffer) // 2
    languages = buffer[:half]
    levels = buffer[half:]

    return list(zip(languages, levels))
